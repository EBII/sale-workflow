-
  Given I activate the 'Use prepayment' on a customer
-
  !record {model: res.partner, id: base.res_partner_4}:
    use_prepayment: True
-
  When I create a sale order for a customer without 'Use prepayment'
-
  !record {model: sale.order, id: partner_prepay_sale_01, view: sale_stock.view_order_form_inherit}:
    partner_id: base.res_partner_3
    order_policy: 'manual'
    order_line:
      - product_id: product.product_product_7
        product_uom_qty: 8
-
  Then the sale order should have the selected policy
-
  !assert {model: sale.order, id: partner_prepay_sale_01, string: The order policy should be 'manual'}:
    - order_policy == 'manual'
-
  When I change the sale order for a customer with 'Use prepayment'
-
  !record {model: sale.order, id: partner_prepay_sale_01, view: sale_stock.view_order_form_inherit}:
    partner_id: base.res_partner_4
-
  Then the sale order should have the order policy 'prepaid'
-
  !assert {model: sale.order, id: partner_prepay_sale_01, string: The order policy should be 'prepaid'}:
    - order_policy == 'prepaid'
